(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[533],{1530:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/scrcpy",function(){return n(3924)}])},3924:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return st}});var r=n(3231),i=n.n(r),o=n(9837),a=n(8061),s=n(3639),c=n(7227),l=n(9108),d=n(1411),u=n(5783),p=function(e){var t=e.className,n=s.useState((function(){return(0,l.z)()}))[0],r=e.id,i=void 0===r?n:r,o=s.useRef({hostId:i,rootRef:s.useRef(null),notifyLayersChanged:function(){}});return s.useImperativeHandle(e.componentRef,(function(){return o.current})),s.useEffect((function(){(0,u._Y)(i,o.current),(0,u.EQ)(i)}),[]),(0,c.k)((function(){(0,u.nw)(i,o.current),(0,u.EQ)(i)})),s.createElement("div",(0,a.pi)({},e,{className:(0,d.i)("ms-LayerHost",t),ref:o.current.rootRef}))},h=n(3803),f=n(3485),v=n(7323),g=n(6133),w=n(2773),m=n(1298),y=n(9962),b=n(4670),x=n(6483),S=n(7221),P=n(2280),k=n(5130),C=n(3560),_=n(421),D=n(2828),z=n(7015),E=n(8144),j=n.n(E),I=n(9017),L=n(2041),O=n(4606);class T{adb;options;constructor(e,t){this.adb=e,this.options=t}initialize(){}dispose(){}}class M extends T{connect(){return this.adb.createSocket("localabstract:scrcpy")}async connectAndRetry(){for(let t=0;t<100;t++)try{return await this.connect()}catch(e){await(0,O.gw)(100)}throw new Error("Can't connect to server after 100 retries")}async connectVideoStream(){const{readable:e}=await this.connectAndRetry();if(this.options.sendDummyByte){const t=e.getReader(),{done:n,value:r}=await t.read();if(n||1!==r.byteLength||0!==r[0])throw new Error("Unexpected response from server");t.releaseLock()}return e}async getStreams(){const e=await this.connectVideoStream();let t;if(this.options.control&&(t=await this.connectAndRetry()),this.options.sendDeviceMeta){const t=e.getReader(),{done:n,value:r}=await t.read();if(n||68!==r.byteLength)throw new Error("Unexpected response from server");t.releaseLock()}return[e,t]}}class V extends T{streams;address;async initialize(){await this.adb.reverse.remove("localabstract:scrcpy").catch((()=>{}));const e=new TransformStream;this.streams=e.readable.getReader();const t=e.writable.getWriter();this.address=await this.adb.reverse.add("localabstract:scrcpy","tcp:27183",(e=>(t.write(e),!0)))}async accept(){return(await this.streams.read()).value}async getStreams(){const{readable:e}=await this.accept();let t;if(this.options.control&&(t=await this.accept()),this.options.sendDeviceMeta){const t=e.getReader(),{done:n,value:r}=await t.read();if(n||68!==r.byteLength)throw new Error("Unexpected response from server");t.releaseLock()}return[e,t]}dispose(){this.adb.reverse.remove(this.address)}}class N extends class extends class{raw;get value(){return this.raw.value}set value(e){this.raw.value=e}constructor(e){this.raw=e}getDefaultValue(){return this.raw.getDefaultValue()}formatServerArguments(){return this.raw.formatServerArguments()}getOutputEncoderNameRegex(){return this.raw.getOutputEncoderNameRegex()}createVideoStreamTransformer(){return this.raw.createVideoStreamTransformer()}getControlMessageTypes(){return this.raw.getControlMessageTypes()}serializeBackOrScreenOnControlMessage(e){return this.raw.serializeBackOrScreenOnControlMessage(e)}serializeInjectScrollControlMessage(e){return this.raw.serializeInjectScrollControlMessage(e)}}{createConnection(e){const t={control:!0,sendDummyByte:!0,sendDeviceMeta:!0};return this.value.tunnelForward?new M(e,t):new V(e,t)}}{createConnection(e){const t={...this.getDefaultValue(),...this.value};return this.value.tunnelForward?new M(e,t):new V(e,t)}}var R,U,H,A=n(1788),B=n(8177);!function(e){e[e.InjectKeyCode=0]="InjectKeyCode",e[e.InjectText=1]="InjectText",e[e.InjectTouch=2]="InjectTouch",e[e.InjectScroll=3]="InjectScroll",e[e.BackOrScreenOn=4]="BackOrScreenOn",e[e.ExpandNotificationPanel=5]="ExpandNotificationPanel",e[e.ExpandSettingPanel=6]="ExpandSettingPanel",e[e.CollapseNotificationPanel=7]="CollapseNotificationPanel",e[e.GetClipboard=8]="GetClipboard",e[e.SetClipboard=9]="SetClipboard",e[e.SetScreenPowerMode=10]="SetScreenPowerMode",e[e.RotateDevice=11]="RotateDevice"}(R||(R={})),function(e){e[e.Down=0]="Down",e[e.Up=1]="Up"}(U||(U={})),function(e){e[e.Home=3]="Home",e[e.Back=4]="Back",e[e.VolumeUp=24]="VolumeUp",e[e.VolumeDown=25]="VolumeDown",e[e.A=29]="A",e[e.B=30]="B",e[e.C=31]="C",e[e.D=32]="D",e[e.E=33]="E",e[e.F=34]="F",e[e.G=35]="G",e[e.H=36]="H",e[e.I=37]="I",e[e.J=38]="J",e[e.K=39]="K",e[e.L=40]="L",e[e.M=41]="M",e[e.N=42]="N",e[e.O=43]="O",e[e.P=44]="P",e[e.Q=45]="Q",e[e.R=46]="R",e[e.S=47]="S",e[e.T=48]="T",e[e.U=49]="U",e[e.V=50]="V",e[e.W=51]="W",e[e.X=52]="X",e[e.Y=53]="Y",e[e.Z=54]="Z",e[e.Tab=61]="Tab",e[e.Space=62]="Space",e[e.Enter=66]="Enter",e[e.Delete=67]="Delete",e[e.VolumeMute=164]="VolumeMute",e[e.AppSwitch=187]="AppSwitch"}(H||(H={}));const F=(new B.ZP).uint8("type",R.InjectKeyCode).uint8("action",(0,B.W$)()).uint32("keyCode").uint32("repeat").uint32("metaState"),W=(new B.ZP).uint8("type",R.InjectText).uint32("length").string("text",{lengthField:"length"});var G;!function(e){e[e.Down=0]="Down",e[e.Up=1]="Up",e[e.Move=2]="Move",e[e.Cancel=3]="Cancel",e[e.Outside=4]="Outside",e[e.PointerDown=5]="PointerDown",e[e.PointerUp=6]="PointerUp",e[e.HoverMove=7]="HoverMove",e[e.Scroll=8]="Scroll",e[e.HoverEnter=9]="HoverEnter",e[e.HoverExit=10]="HoverExit",e[e.ButtonPress=11]="ButtonPress",e[e.ButtonRelease=12]="ButtonRelease"}(G||(G={}));const q=(new B.ZP).uint8("type",R.InjectTouch).uint8("action",(0,B.W$)()).uint64("pointerId").uint32("pointerX").uint32("pointerY").uint16("screenWidth").uint16("screenHeight").uint16("pressure").uint32("buttons"),J=(new B.ZP).uint8("type",R.RotateDevice);var K;!function(e){e[e.Off=0]="Off",e[e.Normal=2]="Normal"}(K||(K={}));const Y=(new B.ZP).uint8("type",R.SetScreenPowerMode).uint8("mode",(0,B.W$)());class Z{options;types;writer;constructor(e,t){this.options=t,this.types=t.getControlMessageTypes(),this.writer=e.getWriter()}getTypeValue(e){const t=this.types.indexOf(e);if(-1===t)throw new Error("Not supported");return t}injectKeyCode(e){return this.writer.write(F.serialize({...e,type:this.getTypeValue(R.InjectKeyCode)}))}injectText(e){return this.writer.write(W.serialize({text:e,type:this.getTypeValue(R.InjectText)}))}injectTouch(e){return this.writer.write(q.serialize({...e,type:this.getTypeValue(R.InjectTouch)}))}injectScroll(e){return this.writer.write(this.options.serializeInjectScrollControlMessage({...e,type:this.getTypeValue(R.InjectScroll)}))}async backOrScreenOn(e){const t=this.options.serializeBackOrScreenOnControlMessage({action:e,type:this.getTypeValue(R.BackOrScreenOn)});if(t)return await this.writer.write(t)}setScreenPowerMode(e){return this.writer.write(Y.serialize({mode:e,type:this.getTypeValue(R.SetScreenPowerMode)}))}rotateDevice(){return this.writer.write(J.serialize({type:this.getTypeValue(R.RotateDevice)}))}close(){return this.writer.close()}}var $;!function(e){e[e.Clipboard=0]="Clipboard",e[e.AckClipboard=1]="AckClipboard"}($||($={}));const X=(new B.ZP).uint32("length").string("content",{lengthField:"length"}).extra({type:$.Clipboard});class Q extends A.pC{constructor(){super((async e=>{if(0===(await e.read(1))[0])return await X.deserialize(e);throw new Error("unknown control message type")}))}}const ee={repeatPreviousFrameAfter:"long",maxPtsGapToEncoder:"long"};class te{value;constructor(e){this.value=e}toOptionValue(){const e=Object.entries(this.value).filter((([e,t])=>void 0!==t));if(0!==e.length)return e.map((([e,t])=>{const n=ee[e];return`${r=e,r.replace(/([A-Z])/g,"-$1").toLowerCase()}${n?`:${n}`:""}=${t}`;var r})).join(",")}}const ne="/data/local/tmp/scrcpy-server.jar";function re(e,t){return function(e){return"object"===typeof e&&null!==e&&"function"===typeof e.toOptionValue}(e)&&(e=e.toOptionValue()),void 0===e?t:`${e}`}class ie{buffer;bytePosition=0;bitPosition=0;constructor(e){this.buffer=e}read(e){let t=0;for(let n=0;n<e;n+=1)t=t<<1|this.next();return t}next(){const e=this.buffer[this.bytePosition]>>7-this.bitPosition&1;return this.bitPosition+=1,8===this.bitPosition&&(this.bytePosition+=1,this.bitPosition=0),e}decodeExponentialGolombNumber(){let e=0;for(;0===this.next();)e+=1;return 0===e?0:(1<<e|this.read(e))-1}}function oe(e){for(const t of function*(e){let t=-1,n=0,r=0,i=!1;for(const o of e){if(e[n]=o,n+=1,i){if(o>3)throw new Error("Invalid data");i=!1;continue}if(0==o){r+=1;continue}const a=r;if(r=0,-1===t){if(a>=2&&1===o){n=0,t=0;continue}throw new Error("Invalid data")}if(!(a<2))if(1!==o){if(a>2)throw new Error("Invalid data");switch(o){case 2:throw new Error("Invalid data");case 3:n-=1,i=!0}}else n-=a+1,yield e.subarray(t,n),t=n}if(i||0!==r)throw new Error("Invalid data");yield e.subarray(t,n)}(new Uint8Array(e))){const e=new ie(t);if(0!==e.next())throw new Error("Invalid data");const n=e.read(2);if(7!==e.read(5))continue;if(0===n)throw new Error("Invalid data");const r=e.read(8),i=e.read(8),o=new ie(new Uint8Array([i])),a=!!o.next(),s=!!o.next(),c=!!o.next(),l=!!o.next(),d=!!o.next(),u=!!o.next();if(0!==o.read(2))throw new Error("Invalid data");const p=e.read(8),h=e.decodeExponentialGolombNumber();if(100===r||110===r||122===r||244===r||44===r||83===r||86===r||118===r||128===r||138===r||139===r||134===r){const t=e.decodeExponentialGolombNumber();3===t&&e.next(),e.decodeExponentialGolombNumber(),e.decodeExponentialGolombNumber(),e.next();if(!!e.next()){const n=[];for(let r=0;r<(3!==t?8:12);r++)n[r]=!!e.next(),n[r]}}e.decodeExponentialGolombNumber();const f=e.decodeExponentialGolombNumber();if(0===f)e.decodeExponentialGolombNumber();else if(1===f){e.next(),e.decodeExponentialGolombNumber(),e.decodeExponentialGolombNumber();const t=e.decodeExponentialGolombNumber(),n=[];for(let r=0;r<t;r++)n[r]=e.decodeExponentialGolombNumber()}e.decodeExponentialGolombNumber(),e.next();const v=e.decodeExponentialGolombNumber(),g=e.decodeExponentialGolombNumber(),w=e.next();w||e.next(),e.next();const m=!!e.next();let y,b,x,S;m?(y=e.decodeExponentialGolombNumber(),b=e.decodeExponentialGolombNumber(),x=e.decodeExponentialGolombNumber(),S=e.decodeExponentialGolombNumber()):(y=0,b=0,x=0,S=0);e.next();return{profile_idc:r,constraint_set:i,constraint_set0_flag:a,constraint_set1_flag:s,constraint_set2_flag:c,constraint_set3_flag:l,constraint_set4_flag:d,constraint_set5_flag:u,level_idc:p,seq_parameter_set_id:h,pic_width_in_mbs_minus1:v,pic_height_in_map_units_minus1:g,frame_mbs_only_flag:w,frame_cropping_flag:m,frame_crop_left_offset:y,frame_crop_right_offset:b,frame_crop_top_offset:x,frame_crop_bottom_offset:S}}throw new Error("Invalid data")}var ae,se;!function(e){e.Verbose="verbose",e.Debug="debug",e.Info="info",e.Warn="warn",e.Error="error"}(ae||(ae={})),function(e){e[e.Initial=-2]="Initial",e[e.Unlocked=-1]="Unlocked",e[e.Portrait=0]="Portrait",e[e.Landscape=1]="Landscape",e[e.PortraitFlipped=2]="PortraitFlipped",e[e.LandscapeFlipped=3]="LandscapeFlipped"}(se||(se={}));const ce=(new B.ZP).uint64("pts").uint32("size").uint8Array("data",{lengthField:"size"}),le=BigInt(1)<<BigInt(63),de=(new B.ZP).uint8("type",R.BackOrScreenOn),ue=(new B.ZP).uint8("type",R.InjectScroll).uint32("pointerX").uint32("pointerY").uint16("screenWidth").uint16("screenHeight").int32("scrollX").int32("scrollY");class pe{value;constructor(e){new.target===pe&&e.logLevel===ae.Verbose&&(e.logLevel=ae.Debug),new.target===pe&&e.lockVideoOrientation===se.Initial&&(e.lockVideoOrientation=se.Unlocked),this.value=e}getArgumentOrder(){return["logLevel","maxSize","bitRate","maxFps","lockVideoOrientation","tunnelForward","crop","sendFrameMeta","control","displayId","showTouches","stayAwake","codecOptions","encoderName"]}getDefaultValue(){return{logLevel:ae.Debug,maxSize:0,bitRate:8e6,maxFps:0,lockVideoOrientation:se.Unlocked,tunnelForward:!1,crop:"-",sendFrameMeta:!0,control:!0,displayId:0,showTouches:!1,stayAwake:!1,codecOptions:new te({}),encoderName:"-"}}formatServerArguments(){const e=this.getDefaultValue();return this.getArgumentOrder().map((t=>re(this.value[t]||e[t],"-")))}getOutputEncoderNameRegex(){return/\s+scrcpy --encoder-name '(.*?)'/}createVideoStreamTransformer(){if(!1===this.value.sendFrameMeta)return new A.GJ({transform(e,t){t.enqueue({type:"frame",data:e})}});let e,t=new A.gL(ce);return{writable:t.writable,readable:t.readable.pipeThrough(new A.GJ({transform(t,n){if(t.pts===le){const r=oe(t.data.slice().buffer),{profile_idc:i,constraint_set:o,level_idc:a,pic_width_in_mbs_minus1:s,pic_height_in_map_units_minus1:c,frame_mbs_only_flag:l,frame_crop_left_offset:d,frame_crop_right_offset:u,frame_crop_top_offset:p,frame_crop_bottom_offset:h}=r,f=16*(s+1),v=(c+1)*(2-l)*16,g=2*d,w=2*u,m=2*p,y=2*h,b=f-g-w,x=v-m-y;return e=t.data,void n.enqueue({type:"configuration",data:{profileIndex:i,constraintSet:o,levelIndex:a,encodedWidth:f,encodedHeight:v,cropLeft:g,cropRight:w,cropTop:m,cropBottom:y,croppedWidth:b,croppedHeight:x}})}let r;e?(r=new Uint8Array(e.byteLength+t.data.byteLength),r.set(e),r.set(t.data,e.byteLength),e=void 0):r=t.data,n.enqueue({type:"frame",pts:t.pts,data:r})}}))}}getControlMessageTypes(){return[R.InjectKeyCode,R.InjectText,R.InjectTouch,R.InjectScroll,R.BackOrScreenOn,R.ExpandNotificationPanel,R.CollapseNotificationPanel,R.GetClipboard,R.SetClipboard,R.SetScreenPowerMode,R.RotateDevice]}serializeBackOrScreenOnControlMessage(e){if(e.action===U.Down)return de.serialize(e)}serializeInjectScrollControlMessage(e){return ue.serialize(e)}}const he=(new B.ZP).fields(de).uint8("action",(0,B.W$)());class fe extends pe{constructor(e){super(e)}getArgumentOrder(){return super.getArgumentOrder().concat(["powerOffOnClose"])}getDefaultValue(){return{...super.getDefaultValue(),powerOffOnClose:!1}}getOutputEncoderNameRegex(){return/\s+scrcpy --encoder '(.*?)'/}getControlMessageTypes(){const e=super.getControlMessageTypes();return e.splice(6,0,R.ExpandSettingPanel),e}serializeBackOrScreenOnControlMessage(e){return he.serialize(e)}}class ve extends fe{constructor(e){super(e)}getDefaultValue(){return{...super.getDefaultValue(),clipboardAutosync:!0}}formatServerArguments(){return Object.entries(this.value).map((([e,t])=>[e,re(t,void 0)])).filter((e=>void 0!==e[1])).map((([e,t])=>{return`${n=e,n.replace(/([A-Z])/g,"_$1").toLowerCase()}=${t}`;var n}))}}const ge=(new B.ZP).fields(ue).int32("buttons");class we extends ve{constructor(e){e.rawVideoStream&&(e.sendDeviceMeta=!1,e.sendFrameMeta=!1,e.sendDummyByte=!1),super(e)}getDefaultValue(){return{...super.getDefaultValue(),downsizeOnError:!0,sendDeviceMeta:!0,sendDummyByte:!0,rawVideoStream:!1}}serializeInjectScrollControlMessage(e){return ge.serialize(e)}}const me=BigInt(1)<<BigInt(62);class ye extends we{constructor(e){super(e)}getDefaultValue(){return{...super.getDefaultValue(),cleanup:!0}}createVideoStreamTransformer(){const e=super.createVideoStreamTransformer();return{writable:e.writable,readable:e.readable.pipeThrough(new A.GJ({transform(e,t){"frame"===e.type?(void 0!==e.pts&&e.pts&me&&(e.keyframe=!0,e.pts&=~me),t.enqueue(e)):t.enqueue(e)}}))}}}class be extends ye{constructor(e){super(e)}getDefaultValue(){return{...super.getDefaultValue(),powerOn:!0}}}class xe extends A.Pz{array;index=0;constructor(e){super({start:async()=>{await Promise.resolve(),this.array=e},pull:e=>{this.index<this.array.length?(e.enqueue(this.array[this.index]),this.index+=1):e.close()}})}}class Se extends A.Pz{streams;index=0;reader;constructor(...e){super({start:async t=>{await Promise.resolve(),this.streams=e,this.advance(t)},pull:async e=>{const t=await this.reader.read();t.done?this.advance(e):e.enqueue(t.value)}})}advance(e){this.index<this.streams.length?(this.reader=this.streams[this.index].getReader(),this.index+=1):e.close()}}class Pe{static pushServer(e,t=ne){let n;return new A.BF({start:async()=>(n=await e.sync(),n.write(t)),async close(){await n.dispose()}})}static async start(e,t,n,r){const i=r.createConnection(e);let o;try{await i.initialize(),o=await e.subprocess.spawn([`CLASSPATH=${t}`,"app_process","/","com.genymobile.scrcpy.Server",n,...r.formatServerArguments()],{protocols:[I.vf]});const a=o.stdout.pipeThrough(new A.xU).pipeThrough(new A.Jb("\n")),s=[],c=new AbortController,l=a.pipeTo(new A.Vj({write(e){s.push(e)}}),{signal:c.signal,preventCancel:!0}).catch((()=>{})),d=await Promise.race([o.exit,i.getStreams()]);if("number"===typeof d){const e=new Error("scrcpy server exited prematurely");throw e.output=s,e}c.abort(),await l;const[u,p]=d;return new Pe(r,o,new Se(new xe(s),a),u,p)}catch(a){throw await(o?.kill()),a}finally{i.dispose()}}static async getEncoders(e,t,n,r){r.value.encoderName="_",r.value.control=!1,r.value.sendDeviceMeta=!1,r.value.sendDummyByte=!1;const i=await Pe.start(e,t,n,r),o=r.getOutputEncoderNameRegex(),a=[];return await i.stdout.pipeTo(new A.Vj({write(e){const t=e.match(o);t&&a.push(t[1])}})),a}static async getDisplays(e,t,n,r){r.value.displayId=-1,r.value.control=!1,r.value.sendDeviceMeta=!1,r.value.sendDummyByte=!1;try{await Pe.start(e,t,n,r)}catch(i){if(i instanceof Error){const e=i.output,t=/\s+scrcpy --display (\d+)/,n=[];for(const r of e){const e=r.match(t);e&&n.push(Number.parseInt(e[1],10))}return n}}throw new Error("failed to get displays")}process;_stdout;get stdout(){return this._stdout}get exit(){return this.process.exit}_screenWidth;get screenWidth(){return this._screenWidth}_screenHeight;get screenHeight(){return this._screenHeight}_videoStream;get videoStream(){return this._videoStream}_controlMessageSerializer;get controlMessageSerializer(){return this._controlMessageSerializer}_deviceMessageStream;get deviceMessageStream(){return this._deviceMessageStream}constructor(e,t,n,r,i){this.process=t,this._stdout=n,this._videoStream=r.pipeThrough(e.createVideoStreamTransformer()).pipeThrough(new A.N7((e=>{"configuration"===e.type&&(this._screenWidth=e.data.croppedWidth,this._screenHeight=e.data.croppedHeight)}))),i&&(this._controlMessageSerializer=new Z(i.writable,e),this._deviceMessageStream=i.readable.pipeThrough(new Q))}async close(){await this.process.kill()}}var ke,Ce;let _e;!function(e){e[e.Baseline=1]="Baseline",e[e.Main=2]="Main",e[e.Extended=4]="Extended",e[e.High=8]="High",e[e.High10=16]="High10",e[e.High422=32]="High422",e[e.High444=64]="High444",e[e.ConstrainedBaseline=65536]="ConstrainedBaseline",e[e.ConstrainedHigh=524288]="ConstrainedHigh"}(ke||(ke={})),function(e){e[e.Level1=1]="Level1",e[e.Level1b=2]="Level1b",e[e.Level11=4]="Level11",e[e.Level12=8]="Level12",e[e.Level13=16]="Level13",e[e.Level2=32]="Level2",e[e.Level21=64]="Level21",e[e.Level22=128]="Level22",e[e.Level3=256]="Level3",e[e.Level31=512]="Level31",e[e.Level32=1024]="Level32",e[e.Level4=2048]="Level4",e[e.Level41=4096]="Level41",e[e.Level42=8192]="Level42",e[e.Level5=16384]="Level5",e[e.Level51=32768]="Level51",e[e.Level52=65536]="Level52",e[e.Level6=131072]="Level6",e[e.Level61=262144]="Level61",e[e.Level62=524288]="Level62"}(Ce||(Ce={}));let De=!1;const ze=[];let Ee=0;const je=new Map;class Ie extends L.Xn{streamId;pictureReadyEvent=new L.vp;get onPictureReady(){return this.pictureReadyEvent.event}constructor(e){super(),this.streamId=e,this.addDisposable(function(e,t){return je.set(e,t),{dispose(){je.delete(e)}}}(e,this.handlePictureReady))}handlePictureReady=e=>{this.pictureReadyEvent.fire(e)};feed(e){_e.postMessage({type:"decode",data:e,offset:0,length:e.byteLength,renderStateId:this.streamId},[e])}dispose(){super.dispose(),_e.postMessage({type:"release",renderStateId:this.streamId})}}let Le;function Oe(){return Le||(Le=Promise.all([n.e(737).then(n.t.bind(n,8737,19)),n.e(224).then(n.t.bind(n,7224,19))]).then((([e,{default:t}])=>({YuvBuffer:e,YuvCanvas:t})))),Le}class Te{maxProfile=ke.Baseline;maxLevel=Ce.Level4;_renderer;get renderer(){return this._renderer}_frameRendered=0;get frameRendered(){return this._frameRendered}_writable;get writable(){return this._writable}_yuvCanvas;_initializer;constructor(){Oe(),this._renderer=document.createElement("canvas"),this._writable=new A.Vj({write:async e=>{switch(e.type){case"configuration":this.configure(e.data);break;case"frame":if(!this._initializer)throw new Error("Decoder not initialized");(await this._initializer.promise).feed(e.data.slice().buffer)}}})}async configure(e){this.dispose(),this._initializer=new O.hP;const{YuvBuffer:t,YuvCanvas:r}=await Oe();this._yuvCanvas||(this._yuvCanvas=r.attach(this._renderer));const{encodedWidth:i,encodedHeight:o}=e,a=i/2,s=o/2;this._renderer.width=e.croppedWidth,this._renderer.height=e.croppedHeight;const c=t.format({width:i,height:o,chromaWidth:a,chromaHeight:s,cropLeft:e.cropLeft,cropTop:e.cropTop,cropWidth:e.croppedWidth,cropHeight:e.croppedHeight,displayWidth:e.croppedWidth,displayHeight:e.croppedHeight}),l=await function(){if(_e||(_e=new Worker(new URL(n.p+n.u(661),n.b)),_e.addEventListener("message",(e=>{const{data:t}=e;switch(t.type){case"decoderReady":De=!0;for(const e of ze)e.resolve(new Ie(Ee)),Ee+=1;ze.length=0;break;case"pictureReady":je.get(t.renderStateId)?.(t)}}))),!De){const e=new O.hP;return ze.push(e),e.promise}const e=new Ie(Ee);return Ee+=1,Promise.resolve(e)}();this._initializer.resolve(l);const d=i*o,u=d+a*s;l.onPictureReady((({data:e})=>{this._frameRendered+=1;const n=new Uint8Array(e),r=t.frame(c,t.lumaPlane(c,n,i,0),t.chromaPlane(c,n,a,d),t.chromaPlane(c,n,a,u));this._yuvCanvas.drawFrame(r)}))}dispose(){this._initializer?.promise.then((e=>e.dispose())),this._initializer=void 0}}function Me(e){return e.toString(16).padStart(2,"0").toUpperCase()}class Ve{maxProfile=void 0;maxLevel=void 0;_writable;get writable(){return this._writable}_renderer;get renderer(){return this._renderer}_frameRendered=0;get frameRendered(){return this._frameRendered}context;decoder;lastFrame;animationFrame=0;constructor(){this._renderer=document.createElement("canvas"),this.context=this._renderer.getContext("2d"),this.decoder=new VideoDecoder({output:e=>{this.lastFrame&&this.lastFrame.close(),this.lastFrame=e,this.animationFrame||this.render()},error(){}}),this._writable=new A.Vj({write:async e=>{switch(e.type){case"configuration":this.configure(e.data);break;case"frame":this.decoder.decode(new EncodedVideoChunk({type:!1===e.keyframe?"delta":"key",timestamp:0,data:e.data}))}}})}render=()=>{this.lastFrame&&(this._frameRendered+=1,this.context.drawImage(this.lastFrame,0,0),this.lastFrame.close(),this.lastFrame=void 0),this.animationFrame=requestAnimationFrame(this.render)};configure(e){const{profileIndex:t,constraintSet:n,levelIndex:r}=e;this._renderer.width=e.croppedWidth,this._renderer.height=e.croppedHeight;const i=`avc1.${[t,n,r].map(Me).join("")}`;this.decoder.configure({codec:i,optimizeForLatency:!0})}dispose(){cancelAnimationFrame(this.animationFrame),this.decoder.close()}}var Ne="1.24",Re=n(3617),Ue=n(5353),He=n(2373);function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Be(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(r,i)}function Fe(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Be(o,r,i,a,s,"next",e)}function s(e){Be(o,r,i,a,s,"throw",e)}a(void 0)}))}}function We(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ge(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qe(e,t,n){return t&&Ge(e.prototype,t),n&&Ge(e,n),e}function Je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Je(e,t,n[t])}))}return e}function Ye(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);a=!0);}catch(c){s=!0,i=c}finally{try{a||null==n.return||n.return()}finally{if(s)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ae(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Ze,$e=new n.U(n(4439)),Xe=function(){function e(t){We(this,e),this._downloaded=0,this._total=0,this.progressEvent=new L.vp,this.promise=this.fetch(t)}return e.prototype.fetch=function(e){var t=this;return Fe(i().mark((function n(){var r,o,a,s,c,l,d,u,p,h,f,v,g;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,window.fetch(e);case 2:r=n.sent,t._total=Number.parseInt(null!==(o=r.headers.get("Content-Length"))&&void 0!==o?o:"0",10),t.progressEvent.fire([t._downloaded,t._total]),a=r.body.getReader(),s=[];case 8:return n.next=11,a.read();case 11:if(!(c=n.sent).done){n.next=14;break}return n.abrupt("break",19);case 14:s.push(c.value),t._downloaded+=c.value.byteLength,t.progressEvent.fire([t._downloaded,t._total]),n.next=8;break;case 19:for(t._total=s.reduce((function(e,t){return e+t.byteLength}),0),l=new Uint8Array(t._total),d=0,u=!0,p=!1,h=void 0,n.prev=23,f=s[Symbol.iterator]();!(u=(v=f.next()).done);u=!0)g=v.value,l.set(g,d),d+=g.byteLength;n.next=31;break;case 27:n.prev=27,n.t0=n.catch(23),p=!0,h=n.t0;case 31:n.prev=31,n.prev=32,u||null==f.return||f.return();case 34:if(n.prev=34,!p){n.next=37;break}throw h;case 37:return n.finish(34);case 38:return n.finish(31);case 39:return n.abrupt("return",l);case 40:case"end":return n.stop()}}),n,null,[[23,27,31,39],[32,,34,38]])})))()},qe(e,[{key:"downloaded",get:function(){return this._downloaded}},{key:"total",get:function(){return this._total}},{key:"onProgress",get:function(){return this.progressEvent.event}}]),e}();function Qe(e){return Ze||(Ze=new Xe($e)).promise.catch((function(e){Ze=void 0})),e&&(Ze.onProgress(e),e([Ze.downloaded,Ze.total])),Ze.promise}function et(e,t,n){return e<t?t:e>n?n:e}var tt=(0,_.Z)({labelRight:{marginLeft:"4px"},video:{transformOrigin:"center center"}}),nt=(0,z.Pi)((function(e){var t=e.definition,n=e.settings,r=e.onChange,i=tt(),a=(0,o.jsxs)(h.K,{horizontal:!0,verticalAlign:"center",children:[(0,o.jsx)("span",{children:t.label}),!!t.description&&(0,o.jsx)(f.G,{content:t.description,children:(0,o.jsx)(v.J,{className:i.labelRight,iconName:He.PJ.Info})}),t.labelExtra]});switch(t.type){case"text":return(0,o.jsx)(g.n,{label:a,placeholder:t.placeholder,value:n[t.key],onChange:function(e,n){return r(t.key,n)}});case"dropdown":return(0,o.jsx)(w.L,{label:a,options:t.options,placeholder:t.placeholder,selectedKey:n[t.key],onChange:function(e,n){return r(t.key,n.key)}});case"toggle":return(0,o.jsx)(m.Z,{label:a,checked:n[t.key],onChange:function(e,n){return r(t.key,n)}});case"number":return(0,o.jsx)(y.k,{label:t.label,labelPosition:b.L.top,min:t.min,max:t.max,step:t.step,value:n[t.key].toString(),onChange:function(e,n){return r(t.key,Number.parseInt(n,10))}})}})),rt=function(){function e(){var t=this;We(this,e),this.running=!1,this.deviceView=null,this.rendererContainer=null,this.logVisible=!1,this.log=[],this.settingsVisible=!1,this.demoModeVisible=!1,this.navigationBarVisible=!0,this.width=0,this.height=0,this.rotate=0,this.client=void 0,this.encoders=[];var n=this;this.updateEncoders=Fe(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.pushServer();case 3:return e.next=5,Pe.getEncoders(Ue.q.device,ne,Ne,new N(new be({logLevel:ae.Debug,tunnelForward:n.settings.tunnelForward})));case 5:t=e.sent,(0,D.z)((function(){n.encoders=t,n.settings.encoderName&&n.encoders.includes(n.settings.encoderName)||(n.settings.encoderName=n.encoders[0])})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),Ue.q.showErrorDialog(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),this.decoders=[{key:"tinyh264",name:"TinyH264 (Software)",Constructor:Te}],this.decoder=void 0,this.fpsCounterIntervalId=void 0,this.fps=0,this.displays=[];var r=this;this.updateDisplays=Fe(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,r.pushServer();case 3:return e.next=5,Pe.getDisplays(Ue.q.device,ne,Ne,new N(new be({logLevel:ae.Debug,tunnelForward:r.settings.tunnelForward})));case 5:t=e.sent,(0,D.z)((function(){r.displays=t,r.settings.displayId&&r.displays.includes(r.settings.displayId)||(r.settings.displayId=r.displays[0])})),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),Ue.q.showErrorDialog(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),this.connecting=!1,this.serverTotalSize=0,this.serverDownloadedSize=0,this.debouncedServerDownloadedSize=0,this.serverDownloadSpeed=0,this.serverUploadedSize=0,this.debouncedServerUploadedSize=0,this.serverUploadSpeed=0,this.settings={maxSize:1080,bitRate:4e6,lockVideoOrientation:se.Unlocked,displayId:0,crop:"",powerOn:!0};var o=this;this.start=Fe(i().mark((function e(){var t,n,r,a,s,c,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ue.q.device){e.next=2;break}return e.abrupt("return");case 2:if(e.prev=2,o.settings.decoder){e.next=5;break}throw new Error("No available decoder");case 5:return(0,D.z)((function(){o.serverTotalSize=0,o.serverDownloadedSize=0,o.debouncedServerDownloadedSize=0,o.serverUploadedSize=0,o.debouncedServerUploadedSize=0,o.connecting=!0})),t=setInterval((0,D.aD)((function(){o.serverDownloadSpeed=o.serverDownloadedSize-o.debouncedServerDownloadedSize,o.debouncedServerDownloadedSize=o.serverDownloadedSize})),1e3),e.prev=8,e.next=11,Qe((0,D.aD)((function(e){var t=Ye(e,2),n=t[0],r=t[1];o.serverDownloadedSize=n,o.serverTotalSize=r})));case 11:n=e.sent,(0,D.z)((function(){o.serverDownloadSpeed=o.serverDownloadedSize-o.debouncedServerDownloadedSize,o.debouncedServerDownloadedSize=o.serverDownloadedSize}));case 13:return e.prev=13,clearInterval(t),e.finish(13);case 16:return t=setInterval((0,D.aD)((function(){o.serverUploadSpeed=o.serverUploadedSize-o.debouncedServerUploadedSize,o.debouncedServerUploadedSize=o.serverUploadedSize})),1e3),e.prev=17,e.next=20,new A.Pz({start:function(e){e.enqueue(n),e.close()}}).pipeThrough(new A.Cc(I.j4)).pipeThrough(new He.hK((0,D.aD)((function(e){o.serverUploadedSize=e})))).pipeTo(Pe.pushServer(Ue.q.device));case 20:(0,D.z)((function(){o.serverUploadSpeed=o.serverUploadedSize-o.debouncedServerUploadedSize,o.debouncedServerUploadedSize=o.serverUploadedSize}));case 21:return e.prev=21,clearInterval(t),e.finish(21);case 24:return a=null!==(r=o.decoders.find((function(e){return e.key===o.settings.decoder})))&&void 0!==r?r:o.decoders[0],s=new a.Constructor,(0,D.z)((function(){o.decoder=s;var e=0;o.fpsCounterIntervalId=setInterval((0,D.aD)((function(){o.fps=s.frameRendered-e,e=s.frameRendered})),1e3)})),c=new N(new be(Ke({logLevel:ae.Debug},o.settings,{sendDeviceMeta:!1,sendDummyByte:!1,codecOptions:o.settings.ignoreDecoderCodecArgs?void 0:new te({profile:s.maxProfile,level:s.maxLevel})}))),(0,D.z)((function(){o.log=[],o.log.push("[client] Server version: ".concat(Ne)),o.log.push("[client] Server arguments: ".concat(c.formatServerArguments().join(" ")))})),e.next=32,Pe.start(Ue.q.device,ne,Ne,c);case 32:if((l=e.sent).stdout.pipeTo(new A.Vj({write:(0,D.aD)((function(e){o.log.push(e)}))})),l.videoStream.pipeThrough(new A.N7((0,D.aD)((function(e){if("configuration"===e.type){var t=e.data,n=t.croppedWidth,r=t.croppedHeight;o.log.push("[client] Video size changed: ".concat(n,"x").concat(r)),o.width=n,o.height=r}})))).pipeTo(s.writable).catch((function(){})),l.exit.then(o.dispose),l.deviceMessageStream.pipeTo(new A.Vj({write:function(e){if(e.type===$.Clipboard)window.navigator.clipboard.writeText(e.content)}})).catch((function(){})),!o.settings.turnScreenOff){e.next=40;break}return e.next=40,l.controlMessageSerializer.setScreenPowerMode(K.Off);case 40:(0,D.z)((function(){o.client=l,o.running=!0})),e.next=46;break;case 43:e.prev=43,e.t0=e.catch(2),Ue.q.showErrorDialog(e.t0);case 46:return e.prev=46,(0,D.z)((function(){o.connecting=!1})),e.finish(46);case 49:case"end":return e.stop()}}),e,null,[[2,43,46,49],[8,,13,16],[17,,21,24]])}))),this.handleBackPointerDown=function(e){t.client&&0===e.button&&(e.currentTarget.setPointerCapture(e.pointerId),t.client.controlMessageSerializer.backOrScreenOn(U.Down))},this.handleBackPointerUp=function(e){t.client&&0===e.button&&t.client.controlMessageSerializer.backOrScreenOn(U.Up)},this.handleHomePointerDown=function(e){t.client&&0===e.button&&(e.currentTarget.setPointerCapture(e.pointerId),t.client.controlMessageSerializer.injectKeyCode({action:U.Down,keyCode:H.Home,repeat:0,metaState:0}))},this.handleHomePointerUp=function(e){t.client&&0===e.button&&t.client.controlMessageSerializer.injectKeyCode({action:U.Up,keyCode:H.Home,repeat:0,metaState:0})};var a=this;this.handleAppSwitchPointerDown=function(){var e=Fe(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.client){e.next=2;break}return e.abrupt("return");case 2:if(0===t.button){e.next=4;break}return e.abrupt("return");case 4:t.currentTarget.setPointerCapture(t.pointerId),a.client.controlMessageSerializer.injectKeyCode({action:U.Down,keyCode:H.AppSwitch,repeat:0,metaState:0});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var s=this;this.handleAppSwitchPointerUp=function(){var e=Fe(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s.client){e.next=2;break}return e.abrupt("return");case 2:if(0===t.button){e.next=4;break}return e.abrupt("return");case 4:s.client.controlMessageSerializer.injectKeyCode({action:U.Up,keyCode:H.AppSwitch,repeat:0,metaState:0});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.injectTouch=function(e,n){if(t.client){var r=t.calculatePointerPosition(n.clientX,n.clientY),i=r.x,o=r.y;t.client.controlMessageSerializer.injectTouch({action:e,pointerId:"mouse"===n.pointerType?BigInt(-1):BigInt(n.pointerId),screenWidth:t.client.screenWidth,screenHeight:t.client.screenHeight,pointerX:i,pointerY:o,pressure:65535*n.pressure,buttons:n.buttons})}},this.handlePointerDown=function(e){t.rendererContainer.focus(),e.preventDefault(),e.currentTarget.setPointerCapture(e.pointerId),t.injectTouch(G.Down,e)},this.handlePointerMove=function(e){t.injectTouch(0===e.buttons?G.HoverMove:G.Move,e)},this.handlePointerUp=function(e){t.injectTouch(G.Up,e)},this.handleWheel=function(e){if(t.client){e.preventDefault(),e.stopPropagation();var n=t.calculatePointerPosition(e.clientX,e.clientY),r=n.x,i=n.y;t.client.controlMessageSerializer.injectScroll({screenWidth:t.client.screenWidth,screenHeight:t.client.screenHeight,pointerX:r,pointerY:i,scrollX:-Math.sign(e.deltaX),scrollY:-Math.sign(e.deltaY),buttons:0})}},this.handleContextMenu=function(e){e.preventDefault()};var c=this;if(this.handleKeyDown=function(){var e=Fe(i().mark((function e(t){var n,r,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c.client){e.next=2;break}return e.abrupt("return");case 2:if(n=t.key,r=t.code,!n.match(/^[!-`{-~]$/i)){e.next=6;break}return c.client.controlMessageSerializer.injectText(n),e.abrupt("return");case 6:(o={Backspace:H.Delete,Space:H.Space,Enter:H.Enter}[r])&&(c.client.controlMessageSerializer.injectKeyCode({action:U.Down,keyCode:o,metaState:0,repeat:0}),c.client.controlMessageSerializer.injectKeyCode({action:U.Up,keyCode:o,metaState:0,repeat:0}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(0,D.ky)(this,{decoders:D.LO.shallow,settings:D.LO.deep,start:!1,stop:D.aD.bound,dispose:D.aD.bound,handleDeviceViewRef:D.aD.bound,handleRendererContainerRef:D.aD.bound,handleBackPointerDown:!1,handleBackPointerUp:!1,handleHomePointerDown:!1,handleHomePointerUp:!1,handleAppSwitchPointerDown:!1,handleAppSwitchPointerUp:!1,calculatePointerPosition:!1,injectTouch:!1,handlePointerDown:!1,handlePointerMove:!1,handlePointerUp:!1,handleWheel:!1,handleContextMenu:!1,handleKeyDown:!1}),(0,D.EH)((function(){if(Ue.q.device){var e=t;(0,D.z)((function(){e.encoders=[],e.settings.encoderName=void 0,e.displays=[],e.settings.displayId=void 0}))}else t.dispose()})),(0,D.EH)((function(){if(t.rendererContainer&&t.decoder){for(;t.rendererContainer.firstChild;)t.rendererContainer.firstChild.remove();t.rendererContainer.appendChild(t.decoder.renderer)}})),(0,D.EH)((function(){t.settings.decoder=t.decoders[0].key})),"function"===typeof window.VideoDecoder){var l=this;setTimeout((0,D.aD)((function(){l.decoders.unshift({key:"webcodecs",name:"WebCodecs",Constructor:Ve})})),0)}}var t=e.prototype;return t.pushServer=function(){return Fe(i().mark((function e(){var t;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe();case 2:return t=e.sent,e.next=5,new A.Pz({start:function(e){e.enqueue(t),e.close()}}).pipeTo(Pe.pushServer(Ue.q.device));case 5:case"end":return e.stop()}}),e)})))()},t.stop=function(){var e=this;return Fe(i().mark((function t(){var n;return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=3,null===(n=e.client)||void 0===n?void 0:n.close();case 3:e.dispose();case 4:case"end":return t.stop()}}),t)})))()},t.dispose=function(){var e;null===(e=this.decoder)||void 0===e||e.dispose(),this.decoder=void 0,this.fps=0,clearTimeout(this.fpsCounterIntervalId),this.client=void 0,this.running=!1},t.handleDeviceViewRef=function(e){this.deviceView=e},t.handleRendererContainerRef=function(e){var t;this.rendererContainer=e,null===(t=this.rendererContainer)||void 0===t||t.addEventListener("wheel",this.handleWheel,{passive:!1})},t.calculatePointerPosition=function(e,t){var n,r=this.rendererContainer.getBoundingClientRect(),i=et((e-r.x)/r.width,0,1),o=et((t-r.y)/r.height,0,1);1&this.rotate&&(i=(n=[o,i])[0],o=n[1]);switch(this.rotate){case 1:o=1-o;break;case 2:i=1-i,o=1-o;break;case 3:i=1-i}return{x:i*this.width,y:o*this.height}},qe(e,[{key:"rotatedWidth",get:function(){return 1&it.rotate?it.height:it.width}},{key:"rotatedHeight",get:function(){return 1&it.rotate?it.width:it.height}},{key:"commandBarItems",get:function(){var e=this,t=[];return this.running?t.push({key:"stop",iconProps:{iconName:He.PJ.Stop},text:"Stop",onClick:this.stop}):t.push({key:"start",disabled:!Ue.q.device,iconProps:{iconName:He.PJ.Play},text:"Start",onClick:this.start}),t.push({key:"fullscreen",disabled:!this.running,iconProps:{iconName:He.PJ.FullScreenMaximize},iconOnly:!0,text:"Fullscreen",onClick:function(){var t;null===(t=e.deviceView)||void 0===t||t.enterFullscreen()}}),t.push({key:"rotateDevice",disabled:!this.running,iconProps:{iconName:He.PJ.Orientation},iconOnly:!0,text:"Rotate Device",onClick:function(){e.client.controlMessageSerializer.rotateDevice()}},{key:"rotateVideoLeft",disabled:!this.running,iconProps:{iconName:He.PJ.RotateLeft},iconOnly:!0,text:"Rotate Video Left",onClick:function(){e.rotate-=1,e.rotate<0&&(e.rotate=3)}},{key:"rotateVideoRight",disabled:!this.running,iconProps:{iconName:He.PJ.RotateRight},iconOnly:!0,text:"Rotate Video Right",onClick:function(){e.rotate=e.rotate+1&3}}),t.push({key:"turnScreenOff",disabled:!this.running,iconProps:{iconName:He.PJ.Lightbulb},iconOnly:!0,text:"Turn Screen Off",onClick:function(){e.client.controlMessageSerializer.setScreenPowerMode(K.Off)}},{key:"turnScreenOn",disabled:!this.running,iconProps:{iconName:He.PJ.LightbulbFilament},iconOnly:!0,text:"Turn Screen On",onClick:function(){e.client.controlMessageSerializer.setScreenPowerMode(K.Normal)}}),this.running&&t.push({key:"fps",text:"FPS: ".concat(this.fps),disabled:!0}),t}},{key:"commandBarFarItems",get:function(){var e=this;return[{key:"NavigationBar",iconProps:{iconName:He.PJ.PanelBottom},checked:this.navigationBarVisible,text:"Navigation Bar",iconOnly:!0,onClick:(0,D.aD)((function(){e.navigationBarVisible=!e.navigationBarVisible}))},{key:"Log",iconProps:{iconName:He.PJ.TextGrammarError},checked:this.logVisible,text:"Log",iconOnly:!0,onClick:(0,D.aD)((function(){e.logVisible=!e.logVisible}))},{key:"Settings",iconProps:{iconName:He.PJ.Settings},checked:this.settingsVisible,text:"Settings",iconOnly:!0,onClick:(0,D.aD)((function(){e.settingsVisible=!e.settingsVisible}))},{key:"DemoMode",iconProps:{iconName:He.PJ.Wand},checked:this.demoModeVisible,text:"Demo Mode",iconOnly:!0,onClick:(0,D.aD)((function(){e.demoModeVisible=!e.demoModeVisible}))},{key:"info",iconProps:{iconName:He.PJ.Info},iconOnly:!0,tooltipHostProps:{content:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("p",{children:[(0,o.jsx)(Re.dL,{href:"https://github.com/Genymobile/scrcpy",spaceAfter:!0,children:"Scrcpy"}),"developed by Genymobile can display the screen with low latency (1~2 frames) and control the device, all without root access."]}),(0,o.jsx)("p",{children:"This is a TypeScript implementation of the client part. Paired with official pre-built server binary."})]}),calloutProps:{calloutMaxWidth:300}}}]}},{key:"settingDefinitions",get:function(){var e=[];return e.push({key:"powerOn",type:"toggle",label:"Turn device on when starting"},{key:"turnScreenOff",type:"toggle",label:"Turn screen off when starting"},{key:"stayAwake",type:"toggle",label:"Stay awake (if plugged in)"},{key:"powerOffOnClose",type:"toggle",label:"Turn device off when exiting"}),e.push({key:"displayId",type:"dropdown",label:"Display",placeholder:"Press refresh to update available displays",labelExtra:(0,o.jsx)(x.h,{iconProps:{iconName:He.PJ.ArrowClockwise},disabled:!Ue.q.device,text:"Refresh",onClick:this.updateDisplays}),options:this.displays.map((function(e){return{key:e,text:e.toString()}}))}),e.push({key:"crop",type:"text",label:"Crop",placeholder:"W:H:X:Y"}),e.push({key:"maxSize",type:"number",label:"Max Resolution (longer side, 0 = unlimited)",min:0,max:2560,step:50}),e.push({key:"bitRate",type:"number",label:"Max Bit Rate",min:100,max:1e8,step:100}),e.push({key:"lockVideoOrientation",type:"dropdown",label:"Lock Video Orientation",options:[{key:se.Unlocked,text:"Unlocked"},{key:se.Initial,text:"Current"},{key:se.Portrait,text:"Portrait"},{key:se.Landscape,text:"Landscape"},{key:se.PortraitFlipped,text:"Portrait (Flipped)"},{key:se.LandscapeFlipped,text:"Landscape (Flipped)"}]}),e.push({key:"encoderName",type:"dropdown",label:"Encoder",placeholder:"Press refresh to update available encoders",labelExtra:(0,o.jsx)(x.h,{iconProps:{iconName:He.PJ.ArrowClockwise},disabled:!Ue.q.device,text:"Refresh",onClick:this.updateEncoders}),options:this.encoders.map((function(e){return{key:e,text:e}}))}),this.decoders.length>1&&e.push({key:"decoder",type:"dropdown",label:"Decoder",options:this.decoders.map((function(e){return{key:e.key,text:e.name,data:e}}))}),e.push({key:"ignoreDecoderCodecArgs",type:"toggle",label:"Ignore decoder's codec arguments",description:"Some decoders don't support all H.264 profile/levels, so they request the device to encode at their highest-supported codec. However, some super old devices may not support that codec so their encoders will fail to start. Use this option to let device choose the codec to be used."}),e.push({key:"tunnelForward",type:"toggle",label:"Use forward connection",description:"Android before version 9 has a bug that prevents reverse tunneling when using ADB over WiFi."}),e}}]),e}(),it=new rt,ot=(0,z.Pi)((function(){var e=(0,C.M)("layerHost"),t=(0,s.useState)(!1),n=t[0],r=t[1];return(0,s.useEffect)((function(){r(!0)}),[]),n?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(p,{id:e,style:{position:"absolute",top:0,bottom:0,left:0,right:0,margin:0,pointerEvents:"none"}}),(0,o.jsx)(S.V,{hidden:!it.connecting,modalProps:{layerProps:{hostId:e}},dialogContentProps:{title:"Connecting..."},children:(0,o.jsxs)(h.K,{tokens:He.WT,children:[(0,o.jsx)(P.Y,{label:"1. Downloading scrcpy server...",percentComplete:it.serverTotalSize?it.serverDownloadedSize/it.serverTotalSize:void 0,description:(0,He.CY)(it.debouncedServerDownloadedSize,it.serverTotalSize,it.serverDownloadSpeed)}),(0,o.jsx)(P.Y,{label:"2. Pushing scrcpy server to device...",progressHidden:0===it.serverTotalSize||it.serverDownloadedSize!==it.serverTotalSize,percentComplete:it.serverUploadedSize/it.serverTotalSize,description:(0,He.CY)(it.debouncedServerUploadedSize,it.serverTotalSize,it.serverUploadSpeed)}),(0,o.jsx)(P.Y,{label:"3. Starting scrcpy server on device...",progressHidden:0===it.serverTotalSize||it.serverUploadedSize!==it.serverTotalSize})]})})]}):null})),at=(0,z.Pi)((function(e){var t=e.className,n=e.style,r=e.children;return it.navigationBarVisible?(0,o.jsxs)(h.K,{className:t,verticalFill:!0,horizontalAlign:"center",style:Ke({height:"40px",background:"#999"},n),children:[r,(0,o.jsxs)(h.K,{verticalFill:!0,horizontal:!0,style:{width:"100%",maxWidth:300},horizontalAlign:"space-evenly",verticalAlign:"center",children:[(0,o.jsx)(x.h,{iconProps:{iconName:He.PJ.Play},style:{transform:"rotate(180deg)",color:"white"},onPointerDown:it.handleBackPointerDown,onPointerUp:it.handleBackPointerUp}),(0,o.jsx)(x.h,{iconProps:{iconName:He.PJ.Circle},style:{color:"white"},onPointerDown:it.handleHomePointerDown,onPointerUp:it.handleHomePointerUp}),(0,o.jsx)(x.h,{iconProps:{iconName:He.PJ.Stop},style:{color:"white"},onPointerDown:it.handleAppSwitchPointerDown,onPointerUp:it.handleAppSwitchPointerUp})]})]}):(0,o.jsx)("div",{className:t,style:n,children:r})})),st=(0,z.Pi)((function(){var e=tt();return(0,o.jsxs)(h.K,Ke({},He.LE,{children:[(0,o.jsx)(j(),{children:(0,o.jsx)("title",{children:"Scrcpy - Android Web Toolbox"})}),(0,o.jsx)(k.X,{items:it.commandBarItems,farItems:it.commandBarFarItems}),(0,o.jsxs)(h.K,{horizontal:!0,grow:!0,styles:{root:{height:0}},children:[(0,o.jsx)(Re.wM,{ref:it.handleDeviceViewRef,width:it.rotatedWidth,height:it.rotatedHeight,BottomElement:at,children:(0,o.jsx)("div",{ref:it.handleRendererContainerRef,tabIndex:-1,className:e.video,style:{width:it.width,height:it.height,transform:"translate(".concat((it.rotatedWidth-it.width)/2,"px, ").concat((it.rotatedHeight-it.height)/2,"px) rotate(").concat(90*it.rotate,"deg)")},onPointerDown:it.handlePointerDown,onPointerMove:it.handlePointerMove,onPointerUp:it.handlePointerUp,onPointerCancel:it.handlePointerUp,onKeyDown:it.handleKeyDown,onContextMenu:it.handleContextMenu})}),(0,o.jsx)("div",{style:{padding:12,overflow:"hidden auto",display:it.logVisible?"block":"none",width:500,fontFamily:"monospace",overflowY:"auto",whiteSpace:"pre-wrap",wordWrap:"break-word"},children:it.log.map((function(e,t){return(0,o.jsx)("div",{children:e},t)}))}),(0,o.jsxs)("div",{style:{padding:12,overflow:"hidden auto",display:it.settingsVisible?"block":"none",width:300},children:[(0,o.jsx)("div",{children:"Changes will take effect on next connection"}),it.settingDefinitions.map((function(e){return(0,o.jsx)(nt,{definition:e,settings:it.settings,onChange:(0,D.aD)((function(e,t){return it.settings[e]=t}))},e.key)}))]}),(0,o.jsx)(Re.bq,{style:{display:it.demoModeVisible?"block":"none"}}),(0,o.jsx)(ot,{})]})]}))}))},4439:function(e,t,n){"use strict";e.exports=n.p+"static/chunks/scrcpy-server.d406f4d14066a1d3"}},function(e){e.O(0,[133,774,888,179],(function(){return t=1530,e(e.s=t);var t}));var t=e.O();_N_E=t}]);
//# sourceMappingURL=scrcpy-db7f58af2f206d13.js.map